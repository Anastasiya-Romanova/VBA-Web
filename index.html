<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Excel-REST - Excel-REST makes working with complex webservices and APIs easy with Excel (Salesforce, Google, and pretty much everything on the internet)">
  <meta name="author" content="Tim Hall">

  <title>Getting Started | Excel-REST</title>

  <link rel="stylesheet" href=".//css/main.css">
  <script src=".//js/vendor/modernizr-2.8.0.min.js"></script>
</head>
<body>
  <div class="l-container">
    <header role="header">
  <h1 class="logo"><span class="logo-excel">Excel</span>-<span class="logo-rest">REST</span></h1>
  <nav class="main-nav">
    <li class="main-nav-item"><a class="btn btn-success download" href="https://github.com/timhall/Excel-REST/releases">Download Excel-REST</a></li>
    <li class="main-nav-item"><a class="issues" href="https://github.com/timhall/Excel-REST/issues">Submit an Issue</a></li>
    <li class="main-nav-item">
      <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
        <input type="hidden" name="business" value="tim.hall.engr@gmail.com">
        <input type="hidden" name="cmd" value="_donations">
        <input type="hidden" name="item_name" value="Excel-REST">
        <input type="hidden" name="item_number" value="Support Excel-REST (Thanks!)">
        <input type="hidden" name="currency_code" value="USD">

        <input class="btn-link donate" type="submit" value="Donate">
      </form>
    </li>
  </nav>
</header>

    <div role="main">
      

<p>Excel-REST makes working with complex webservices and APIs easy with Excel. It includes support for authentication, making async requests, automatically converting and parsing JSON, working with cookies and headers, and much more.</p>
<h2 id="getting-started">Getting started</h2>
<ul>
<li>Download the <a href="https://github.com/timhall/Excel-REST/releases">latest release (v3.1.0)</a></li>
<li>To install/upgrade in an existing file, run <code>install.bat</code> to walk through installation. </li>
<li>To start from scratch, <code>Excel-REST - Blank.xlsm</code> has everything setup and ready to go.</li>
</ul>
<p>For more details see the <a href="https://github.com/timhall/Excel-REST/wiki">Wiki</a></p>
<h2 id="examples">Examples</h2>
<p>The following examples demonstrate using the Google Maps API to get directions between two locations.</p>
<h3 id="getjson-example">GetJSON Example</h3>
<pre><code class="language-vbnet"><span class="keyword">Function</span> GetDirections(Origin <span class="keyword">As</span> <span class="built_in">String</span>, Destination <span class="keyword">As</span> <span class="built_in">String</span>) <span class="keyword">As</span> <span class="built_in">String</span>
    <span class="comment">' Create a RestClient for executing requests</span>
    <span class="comment">' and set a base url that all requests will be appended to</span>
    <span class="keyword">Dim</span> MapsClient <span class="keyword">As</span> <span class="keyword">New</span> RestClient
    MapsClient.BaseUrl = <span class="string">"https://maps.googleapis.com/maps/api/"</span>

    <span class="comment">' Use GetJSON helper to execute simple request and work with response</span>
    <span class="keyword">Dim</span> Resource <span class="keyword">As</span> <span class="built_in">String</span>
    <span class="keyword">Dim</span> Response <span class="keyword">As</span> RestResponse

    Resource = <span class="string">"directions/json?origin="</span> &amp; Origin &amp; <span class="string">"&amp;destination="</span> &amp; Destination &amp; <span class="string">"&amp;sensor=false"</span>
    <span class="keyword">Set</span> Response = MapsClient.GetJSON(Resource)

    <span class="comment">' =&gt; GET https://maps.../api/directions/json?origin=...&amp;destination=...&amp;sensor=false</span>

    ProcessDirections Response
<span class="keyword">End</span> <span class="keyword">Function</span>

<span class="keyword">Public</span> <span class="keyword">Sub</span> ProcessDirections(Response <span class="keyword">As</span> RestResponse)
    <span class="keyword">If</span> Response.StatusCode = Ok <span class="keyword">Then</span>
        <span class="keyword">Dim</span> Route <span class="keyword">As</span> Dictionary
        <span class="keyword">Set</span> Route = Response.Data(<span class="string">"routes"</span>)(<span class="number">1</span>)(<span class="string">"legs"</span>)(<span class="number">1</span>)

        Debug.Print <span class="string">"It will take "</span> &amp; Route(<span class="string">"duration"</span>)(<span class="string">"text"</span>) &amp; _
            <span class="string">" to travel "</span> &amp; Route(<span class="string">"distance"</span>)(<span class="string">"text"</span>) &amp; _
            <span class="string">" from "</span> &amp; Route(<span class="string">"start_address"</span>) &amp; _
            <span class="string">" to "</span> &amp; Route(<span class="string">"end_address"</span>)
    <span class="keyword">Else</span>
        Debug.Print <span class="string">"Error: "</span> &amp; Response.Content
    <span class="keyword">End</span> <span class="keyword">If</span>
<span class="keyword">End</span> <span class="keyword">Sub</span></code></pre>
<p>There are 3 primary components in Excel-REST: </p>
<ol>
<li><code>RestRequest</code> for defining complex requests</li>
<li><code>RestClient</code> for executing requests</li>
<li><code>RestResponse</code> for dealing with responses. </li>
</ol>
<p>In the above example, the request is fairly simple, so we can skip creating a <code>RestRequest</code> and instead use the <code>Client.GetJSON</code> helper to GET json from a specific url. In processing the response, we can look at the <code>StatusCode</code> to make sure the request succeeded and then use the parsed json in the <code>Data</code> parameter to extract complex information from the response. </p>
<h3 id="restrequest-example">RestRequest Example</h3>
<p>If we wish to have more control over the request, the following example uses <code>RestRequest</code> to define a complex request.</p>
<pre><code class="language-vbnet"><span class="keyword">Function</span> GetDirections(Origin <span class="keyword">As</span> <span class="built_in">String</span>, Destination <span class="keyword">As</span> <span class="built_in">String</span>) <span class="keyword">As</span> <span class="built_in">String</span>
    <span class="keyword">Dim</span> MapsClient <span class="keyword">As</span> <span class="keyword">New</span> RestClient
    <span class="comment">' ... Setup client using GetJSON Example</span>

    <span class="comment">' Create a RestRequest for getting directions</span>
    <span class="keyword">Dim</span> DirectionsRequest <span class="keyword">As</span> <span class="keyword">New</span> RestRequest
    DirectionsRequest.Resource = <span class="string">"directions/{format}"</span>
    DirectionsRequest.Method = httpGET

    <span class="comment">' Set the request format -&gt; Sets {format} segment, content-types, and parses the response</span>
    DirectionsRequest.Format = json

    <span class="comment">' (Alternatively, replace {format} segment directly)</span>
    DirectionsRequest.AddUrlSegment <span class="string">"format"</span>, <span class="string">"json"</span>

    <span class="comment">' Add parameters to the request (as querystring for GET calls and body otherwise)</span>
    DirectionsRequest.AddParameter <span class="string">"origin"</span>, Origin
    DirectionsRequest.AddParameter <span class="string">"destination"</span>, Destination

    <span class="comment">' Force parameter as querystring for all requests</span>
    DirectionsRequest.AddQuerystringParam <span class="string">"sensor"</span>, <span class="string">"false"</span>

    <span class="comment">' =&gt; GET https://maps.../api/directions/json?origin=...&amp;destination=...&amp;sensor=false</span>

    <span class="comment">' Execute the request and work with the response</span>
    <span class="keyword">Dim</span> Response <span class="keyword">As</span> RestResponse
    <span class="keyword">Set</span> Response = MapsClient.Execute(DirectionsRequest)

    ProcessDirections Response
<span class="keyword">End</span> <span class="keyword">Function</span>

<span class="keyword">Public</span> <span class="keyword">Sub</span> ProcessDirections(Response <span class="keyword">As</span> RestResponse)
    <span class="comment">' ... Same as previous examples</span>
<span class="keyword">End</span> <span class="keyword">Sub</span></code></pre>
<p>The above example demonstrates some of the powerful feature available with <code>RestRequest</code>. Some of the features include:</p>
<ul>
<li>Url segments (Replace {segment} in resource with value)</li>
<li>Method (GET, POST, PUT, PATCH, DELETE)</li>
<li>Format (json and url-encoded) for content-type and converting/parsing request and response</li>
<li>Parameters and QuerystringParams</li>
<li>Body</li>
<li>Cookies</li>
<li>Headers</li>
</ul>
<p>For more details, see the <code>RestRequest</code> page in with <a href="https://github.com/timhall/Excel-REST/wiki/RestRequest">Wiki</a></p>
<h3 id="async-example">Async Example</h3>
<p>The above examples execute synchronously, but Excel-REST can run them asynchronously with ease so that your program can keep working and handle the response later once the request completes.</p>
<pre><code class="language-vbnet"><span class="keyword">Function</span> GetDirections(Origin <span class="keyword">As</span> <span class="built_in">String</span>, Destination <span class="keyword">As</span> <span class="built_in">String</span>) <span class="keyword">As</span> <span class="built_in">String</span>
    <span class="keyword">Dim</span> MapsClient <span class="keyword">As</span> <span class="keyword">New</span> RestClient
    <span class="keyword">Dim</span> DirectionsRequest <span class="keyword">As</span> <span class="keyword">New</span> RestRequest
    <span class="comment">' ... Create client and request using RestRequest Example</span>

    <span class="comment">' Execute the request asynchronously</span>
    <span class="comment">' Pass in name of Public Sub as callback to be called asynchronously once request completes</span>
    MapsClient.ExecuteAsync DirectionsRequest, <span class="string">"ProcessDirections"</span>

    <span class="comment">' Keep working, handling response later</span>
<span class="keyword">End</span> <span class="keyword">Function</span>

<span class="keyword">Public</span> <span class="keyword">Sub</span> ProcessDirections(Response <span class="keyword">As</span> RestResponse)
    <span class="comment">' (Called asynchronously!)</span>
    <span class="comment">' ... Same as previous examples</span>
<span class="keyword">End</span> <span class="keyword">Sub</span></code></pre>
<h3 id="authentication-example">Authentication Example</h3>
<p>The following example demonstrates using an authenticator with Excel-REST to query Twitter. The <code>TwitterAuthenticator</code> (found in the <code>authenticators/</code> <a href="https://github.com/timhall/Excel-REST/tree/master/authenticators">folder</a>) uses Twitter&#39;s OAuth 1.0a authentication and details of how it was created can be found in the <a href="https://github.com/timhall/Excel-REST/wiki/Implementing-your-own-IAuthenticator">Wiki</a>.</p>
<pre><code class="language-vbnet"><span class="keyword">Function</span> QueryTwitter(query <span class="keyword">As</span> <span class="built_in">String</span>) <span class="keyword">As</span> RestResponse
    <span class="keyword">Dim</span> TwitterClient <span class="keyword">As</span> <span class="keyword">New</span> RestClient
    TwitterClient.BaseUrl = <span class="string">"https://api.twitter.com/1.1/"</span>

    <span class="comment">' Setup authenticator</span>
    <span class="keyword">Dim</span> TwitterAuth <span class="keyword">As</span> <span class="keyword">New</span> TwitterAuthenticator
    TwitterAuth.Setup _
        ConsumerKey:=<span class="string">"Your consumer key"</span>, _
        ConsumerSecret:=<span class="string">"Your consumer secret"</span>
    <span class="keyword">Set</span> TwitterClient.Authenticator = TwitterAUth

    <span class="comment">' Setup query request</span>
    <span class="keyword">Dim</span> Request <span class="keyword">As</span> <span class="keyword">New</span> RestRequest
    Request.Resource = <span class="string">"search/tweets.{format}"</span>
    Request.Format = json
    Request.Method = httpGET
    Request.AddParameter <span class="string">"q"</span>, query
    Request.AddParameter <span class="string">"lang"</span>, <span class="string">"en"</span>
    Request.AddParameter <span class="string">"count"</span>, <span class="number">20</span>

    <span class="comment">' =&gt; GET https://api.twitter.com/1.1/search/tweets.json?q=...&amp;lang=en&amp;count=20</span>
    <span class="comment">'    Authorization Bearer Token... (received and added automatically via TwitterAuthenticator)</span>

    <span class="keyword">Set</span> QueryTwitter = TwitterClient.Execute(Request)
<span class="keyword">End</span> <span class="keyword">Function</span></code></pre>
<p>For more details, check out the <a href="https://github.com/timhall/Excel-REST/wiki">Wiki</a> and <a href="https://github.com/timhall/Excel-REST/tree/master/examples">Examples</a></p>

    </div>
</div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src=".//js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
  <script src=".//js/main.js"></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-38523419-3', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>