---
title: Docs
layout: docs
---
<aside class="toc">
  <a class="toc-title" href="#">
    Excel-REST <span class="version">(4.0.0)</span>
  </a>
  <ul class="toc-section">
    <li><a href="https://github.com/timhall/Excel-REST/">Github Repository</a></li>
  </ul>
  <a class="toc-title" href="#">Introduction</a>
  <a class="toc-title" href="#">
    WebRequest
  </a>
  <ul class="toc-section">
    <li class="toc-subsection"><a href="#WebRequest:Properties">Properties</a></li>
    <li><a href="#Body">Body</a></li>
    <li><a href="#Cookies">Cookies</a></li>
    <li><a href="#Format">Format</a></li>
    <li><a href="#FormattedResource">FormattedResource</a></li>
    <li><a href="#Headers">Headers</a></li>
    <li><a href="#Id">Id</a></li>
    <li><a href="#Method">Method</a></li>
    <li><a href="#Parameters">Parameters</a></li>
    <li><a href="#QuerystringParams">QuerystringParams</a></li>
    <li><a href="#Resource">Resource</a></li>
    <li><a href="#ResponseFormat">ResponseFormat</a></li>
    <li><a href="#RequestFormat">RequestFormat</a></li>
    <li><a href="#UrlSegments">UrlSegments</a></li>
    <li class="toc-subsection"><a href="#WebRequest:Methods">Methods</a></li>
    <li><a href="#AddCookie">AddCookie</a></li>
    <li><a href="#AddHeader">AddHeader</a></li>
    <li><a href="#AddParameter">AddParameter</a></li>
    <li><a href="#AddQuerystringParam">AddQuerystringParam</a></li>
    <li><a href="#AddUrlSegment">AddUrlSegment</a></li>
    <li><a href="#Clone">Clone</a></li>
  </ul>
  <a class="toc-title" href="#">
    WebClient
  </a>
  <ul class="toc-section">
    <li><a href="#"></a></li>
  </ul>
  <a class="toc-title" href="#">
    WebResponse
  </a>
  <ul class="toc-section">
    <li><a href="#"></a></li>
  </ul>
  <a class="toc-title" href="#">
    WebHelpers
  </a>
  <ul class="toc-section">
    <li><a href="#"></a></li>
  </ul>
</aside>
<article class="docs">
  <h2 id="WebRequest" class="docs-title">WebRequest</h2>
  <section class="docs-subsection">
    <h3 id="WebRequest:Properties" class="docs-subsection-title">Properties</h3>
    <p id="Body" class="docs-item">
      <b class="docs-name">Body</b><code>Get|Let|Set {Variant}</code>
      <br>
      <ul>
        <li><code>Get</code> Body value converted to string using <code>RequestFormat</code> or <code>TODO</code></li>
        <li><code>Let</code> Use <code>String</code> or <code>Array</code> for Body</li>
        <li><code>Set</code> Use <code>Collection</code>, <code>Dictionary</code>, or <code>Object</code> for Body</li>
      </ul>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.RequestFormat = WebFormat.JSON

' Let: String|Array
Request.Body = "text"
Request.Body ' = "text"
Request.Body = Array("A", "B", "C")

' Get: Returns Body converted to string
Request.Body ' = "["A","B","C"]"

' Set: Collection|Dictionary|Object
Dim Body As Object
Set Body = New Collection
Body.Add "Howdy!"
Set Request.Body = Body
Request.Body ' = "["Howdy!"]"

Set Body = New Dictionary
Body.Add "a", 123
Body.Add "b", 456
Set Request.Body = Body
Request.Body ' = "{"a":123,"b":456}"
{% endhighlight %}

    </p>
    
    <p id="Cookies" class="docs-item">
      <b class="docs-name">Cookies</b><code>Get|Set {Collection}</code>
      <br>
      <span class="docs-note"></span>To add cookies, use <a href="#AddCookie"><code>AddCookie</code></a>.</span>
      <br>
      <code>Collection</code> of Cookies to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>).
    </p>
    
    <p id="Format" class="docs-item">
      <b class="docs-name">Format</b><code>Get|Set {WebFormat}</code>
      <br>
      Set <code>RequestFormat</code>, <code>ResponseFormat</code>, and <code>Content-Type</code> and <code>Accept</code> headers for the <code>WebRequest</code>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.Format = WebFormat.JSON
' -> Request.RequestFormat = WebFormat.JSON
'    Request.ResponseFormat = WebFormat.JSON
'    Content-Type: application/json
'    Accept: application/json
{% endhighlight %}

    </p>
    
    <p id="FormattedResource" class="docs-item">
      <b class="docs-name">FormattedResource</b><code>Get {String}</code>
      <br>
      Get `Resource` with Url Segments replaced and Querystring added.
      
{% highlight VB.net %}
Dim Request As New WebRequest
Request.Resource = "examples/{id}"
Request.AddUrlSegment "id", 123
Request.AddQuerystringParam "message", "Hello"

Request.FormattedResource ' = "examples/123?message=Hello"
{% endhighlight %}

    </p>
    
    <p id="Headers" class="docs-item">
      <b class="docs-name">Headers</b><code>Get|Set {Collection}</code>
      <br>
      <span class="docs-note"></span>To add headers, use <a href="#AddHeader"><code>AddHeader</code></a>.</span>
      <br>
      <code>Collection</code> of Headers to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>).
    </p>
    
    <p id="Id" class="docs-item">
      <b class="docs-name">Id</b><code>Get {String}</code>
      <br>
      Unique Id of the <code>WebRequest</code> (used internally).
    </p>
    
    <p id="Method" class="docs-item">
      <b class="docs-name">Method</b><code>Get|Let {WebMethod}</code>
      <br>
      Set the HTTP method to be used for the request: GET, POST, PUT, PATCH, DELETE
      
{% highlight VB.net %}
Dim Request As New WebRequest
Request.Method = WebMethod.HTTPGET
Request.Method = WebMethod.HTTPPOST
Request.Method = WebMethod.HTTPPUT
Request.Method = WebMethod.HTTPPATCH
Request.Method = WebMethod.HTTPDELETE
{% endhighlight %}
      
    </p>
    
    <p id="QuerystringParams" class="docs-item">
      <b class="docs-name">QuerystringParams</b><code>Get|Set {Collection}</code>
      <br>
      <span class="docs-note"></span>To add Querystring parameters, use <a href="#AddQuerystringParam"><code>AddQuerystringParam</code></a>.</span>
      <br>
      <code>Collection</code> of Querystring parameters to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>)
    </p>
    
    <p id="Resource" class="docs-item">
      <b class="docs-name">Resource</b><code>Get|Let {String}</code>
      <br>
      Set the request's portion of the url to be appended to the client's <a href="#BaseUrl"><code>BaseUrl</code></a>.
      Can include <a href="#UrlSegments">Url Segments</a> for dynamic values
      and <a href="#QuerystringParams">Querystring parameters</a> are smart enough to be appended to existing querystring
      (or added to resource if there isn't an existing querystring).
      
{% highlight VB.net %}
Dim Client As New WebClient
Client.BaseUrl = "https://api.example.com/"

Dim Request As New WebRequest
Request.Resource = "messages"

' -> Url: https://api.example.com/messages

Request.Resource = "messages/{id}?a=1"
Request.AddUrlSegment "id", 123
Request.AddQuerystringParam "b", 2

' -> Url: https://api.example.com/messages/123?a=1&b=2
{% endhighlight %}
      
    </p>
    
    <p id="ResponseFormat" class="docs-item">
      <b class="docs-name">ResponseFormat</b><code>Get|Let {WebFormat}</code>
      <br>
      Set the format to use for converting the response <code>Content</code> to <code>Data</code> 
      and for the <code>Accept</code> header
      
      <i>Note</i>: If <code>WebFormat.Custom</code> is used, the <code>Accept</code> header
      must be added explicitly with <a href="#AddHeader"><code>AddHeader</code></a> 
      and the <a href="#TODO"><code>TODO</code></a> should be set.

{% highlight VB.net %}
Dim Request As New WebRequest
Request.ResponseFormat = WebFormat.JSON

' -> Accept: application/json

Dim Response As WebResponse
' ... from Execute
Response.Content ' = {"message":"Howdy!"}

' -> Parse Content to JSON Dictionary
Response.Data("message") ' = "Howdy!"

' For custom format, set 
Request.ResponseFormat = WebFormat.Custom
Request.AddHeader "Accept", "..."
Request.TODO = ...
{% endhighlight %}

    </p>
    
    <p id="RequestFormat" class="docs-item">
      <b class="docs-name">RequestFormat</b><code>Get|Let {WebFormat}</code>
      <br>
      Set the format to use for converting the response <code>Content</code> to <code>Data</code> 
      and for the <code>Accept</code> header
      
      <i>Note</i>: If <code>WebFormat.Custom</code> is used, the <code>Content-Type</code> header
      must be added explicitly with <a href="#AddHeader"><code>AddHeader</code></a> 
      and the <a href="#TODO"><code>TODO</code></a> should be set.

{% highlight VB.net %}
Dim Request As New WebRequest
Request.Body = Array("A", "B", "C")

Request.RequestFormat = WebFormat.JSON

' -> Content-Type: application/json
' -> Convert Body to JSON string
Request.Body ' = "["A","B","C"]"

' For custom format, set 
Request.RequestFormat = WebFormat.Custom
Request.AddHeader "Content-Type", "..."
Request.TODO = ...
{% endhighlight %}

    </p>
    
    <p id="UrlSegments" class="docs-item">
      <b class="docs-name">UrlSegments</b><code>Get|Set {Dictionary}</code>
      <br>
      <span class="docs-note"></span>To add Url Segments, use <a href="#AddUrlSegment"><code>AddUrlSegment</code></a>.</span>
      <br>
      <code>Collection</code> of Headers to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>.
      Url Segments are used to easily add dynamic values to <code>Resource</code>.
      Create a Url Segment in <code>Resource</code> with curly brackets and then replace with dynamic value with <a href="#AddUrlSegment"><code>AddUrlSegment</code></a>:
      
{% highlight VB.net %}
Dim Request As New WebRequest

Dim User As String
Dim Id As Long
User = "Tim"
Id = 123

' OK: Use string concatenation for dynamic values
Request.Resource = User & "/messages/" & Id

' BETTER: Use Url Segments for dynamic values
Request.Resource = "{user}/messages/{id}"
Request.AddUrlSegment "user", User
Request.AddUrlSegment "id", Id

Request.FormattedResource ' = "Tim/messages/123"
{% endhighlight %}

    </p>
  </section>
  <section>
    <h3 id="WebRequest:Methods">Methods</h3>
    <p id="AddCookie" class="docs-item">
      <b class="docs-name">AddCookie</b><code>AddCookie(Key, Value)</code>
      <br>
      Add cookie to be sent with request.
    </p>
    <p id="AddHeader" class="docs-item">
      <b class="docs-name">AddHeader</b><code>AddHeader(Key, Value)</code>
      <br>
      Add header to be sent with request.
    </p>
    <p id="AddQuerystringParam" class="docs-item">
      <b class="docs-name">AddQuerystringParam</b><code>AddQuerystringParam(Key, Value)</code>
      <br>
      Add querystring parameter to <code>FormattedResource</code> for request
    </p>
    <p id="AddUrlSegment" class="docs-item">
      <b class="docs-name">AddUrlSegment</b><code>AddUrlSegment(Key, Value)</code>
      <br>
      Add url segment to replace in <code>Resource</code>
      
{% highlight VB.net %}
Dim Request As New WebRequest
Request.Resource = "{user}/messages/{id}"

Request.AddUrlSegment "user", "Tim"
Request.AddUrlSegment "id", 123

Request.FormattedResource ' = "Tim/messages/123"
{% endhighlight %}
      
    </p>
    <p id="Clone" class="docs-item">
      <b class="docs-name">Clone</b><code>Clone() {WebRequest}</code>
      <br>
      Clone the request (used internally for async functionality)
    </p>
  </section>

  <p>
    Items to remove:
    <ul>
      <li><b>Parameters</b>: Explicitly use <code>QuerystringParams</code> or <code>Body</code></li>
      <li><b>BaseUrl</b>: Should only be used in <code>WebClient</code></li>
      <li><b>RequireHTTPS</b>: Should be set explicitly in <code>WebClient.BaseUrl</code> or <code>WebRequest.Resource</code></li>
      <li><b>IncludeContentLength</b>: Should alway be included</li>
      <li><b>FullUrl</b>: Should be determined in <code>WebClient</code></li>
      <li><b>MethodName</b>: Don't need explicit Property for this</li>
      <li><b>FormatName</b>: Only used in <code>{format}</code>, set explicitly if needed</li>
      <li><b>ContentType</b>: Set with <code>AddHeader</code> if needed</li>
      <li><b>Accept</b>: Set with <code>AddHeader</code> if needed</li>
      <li><b>ContentLength</b>: No reason it should be different size than actual content length</li>
      <li><b>AddParameter</b>: Explicitly use <code>AddQuerystringParam</code> or <code>Body</code></li>
      <li><b>AddBody</b>: Use Let/Set with <code>Body</code></li>
      <li><b>AddBodyString</b>: Use Let with <code>Body</code></li>
    </ul>
  </p>

  <h2 id="WebClient">WebClient</h2>
  <section class="docs-subsection">
    <h3 id="WebClient:Properties" class="docs-subsection-title">Properties</h3>
    <p id="Authenticator" class="docs-item">
      <b class="docs-name">Authenticator</b><code>Get|Set {IAuthenticator}</code>
      <br>
      Attach an authenticator to the client for authenticating requests.
      
{% highlight VB.net %}
Dim Client As New WebClient
Dim Auth As New OAuth1Authenticator
Auth.Setup ...

Set Client.Authenticator = Auth
' -> All requests use Auth to add "Authorization" header
{% endhighlight %}
      
    </p>
    <p id="BaseUrl" class="docs-item">
      <b class="docs-name">BaseUrl</b><code>Get|Let {String}</code>
      <br>
      Set base url that is shared by all requests and that the request <code>Resource></code> is appended to
      
{% highlight VB.net %}
' Desired URLs
' https://api.example.com/v1/messages
' https://api.example.com/v1/users/id
'                           ^
' -> Split by shared base url and unique request resource

Dim Client As New WebClient
Client.BaseUrl = "https://api.example.com/v1/"

Dim Request As New WebRequest
Request.Resource = "messages"
Request.Resource = "users/{id}"
{% endhighlight %}
      
    </p>
    <p id="Password" class="docs-item">
      <b class="docs-name">Password</b><code>Get|Let {String}</code>
      <br>
      Password for Basic Authentication
    </p>
    <p id="ProxyBypassList" class="docs-item">
      <b class="docs-name">ProxyBypassList</b>Get|Let {String}<code></code>
      <br>
      Comma separated list of domains to bypass the proxy
    </p>
    <p id="ProxyPassword" class="docs-item">
      <b class="docs-name">ProxyPassword</b><code>Get|Let {String}</code>
      <br>
      Password for proxy
    </p>
    <p id="ProxyServer" class="docs-item">
      <b class="docs-name">ProxyServer</b><code>Get|Let {String}</code>
      <br>
      Proxy server to pass requests through (except for those that match bypass list)
    </p>
    <p id="ProxyUsername" class="docs-item">
      <b class="docs-name">ProxyUsername</b><code>Get|Let {String}</code>
      <br>
      Username for proxy
    </p>
    <p id="TimeoutMS" class="docs-item">
      <b class="docs-name">TimeoutMS</b><code>Get|Let {Long}</code>
      <br>
      Timeout (in milliseconds) to wait for timeout in each request phase (Resolve, Connect, Send, Receive)
    </p>
    <p id="Username" class="docs-item">
      <b class="docs-name">Username</b><code>Get|Let {String}</code>
      <br>
      Username for Basic Authentication
    </p>
  </section>
  <sectionclass="docs-subsection">
    <h3 id="WebClient:Methods" class="docs-subsection-title">Methods</h3>
    <p id="Execute" class="docs-item">
      <b class="docs-name">Execute</b><code>Execute(Request) {WebResponse}</code>
      <br>
      TODO...
    </p>
    <p id="GetJSON" class="docs-item">
      <b class="docs-name">GetJSON</b><code>GetJSON(Url, [Options]) {WebResponse}</code>
      <br>
      TODO...
    </p>
    <p id="PostJSON" class="docs-item">
      <b class="docs-name">PostJSON</b><code>PostJSON(Url, Body, [Options]) {WebResponse}</code>
      <br>
      TODO...
    </p>
    <p id="SetProxy" class="docs-item">
      <b class="docs-name">SetProxy</b><code>SetProxy(Server, [Username], [Password], [BypassList])</code>
      <br>
      TODO...
    </p>
    <p id="PrepareRequest" class="docs-item">
      <b class="docs-name">PrepareRequest</b><code>PrepareRequest(Request) {WebRequest}</code>
      <br>
      (Internal) TODO...
    </p>
    <p id="PrepareHttpRequest" class="docs-item">
      <b class="docs-name">PrepareHttpRequest</b><code>PrepareHttpRequest(Request, [Async]) {WinHttpRequest}</code>
      <br>
      (Internal) TODO...
    </p>
    <p id="PrepareCURL" class="docs-item">
      <b class="docs-name">PrepareCURL</b><code>PrepareCURL(Request) {String}</code>
      <br>
      (Internal) TODO...
    </p>
  </section>
  
  <h2 id="WebResponse">WebResponse</h2>
  <h2 id="WebHelpers">WebHelpers</h2>
  <h2 id="WebAsyncWrapper">WebAsyncWrapper</h2>
</article>
