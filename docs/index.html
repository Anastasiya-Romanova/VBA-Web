---
title: Docs
layout: docs
---
<aside class="toc">
  <a class="toc-title" href="#">
    Excel-REST <span class="version">(4.0.0)</span>
  </a>
  <ul class="toc-section">
    <li><a href="https://github.com/timhall/Excel-REST/">Github Repository</a></li>
  </ul>
  <a class="toc-title" href="#">Introduction</a>
  <ul class="toc-section">
    <li><a href="#Installation">Installation</a></li>
  </ul>
  <a class="toc-title" href="#">
    WebRequest
  </a>
  <ul class="toc-section">
    <li class="toc-subsection"><a href="#WebRequest-Properties">Properties</a></li>
    <li><a href="#Resource">Resource</a></li>
    <li><a href="#Method">Method</a></li>
    <li><a href="#Format">Format</a></li>
    <li><a href="#Body">Body</a></li>
    <li><a href="#RequestFormat">RequestFormat</a></li>
    <li><a href="#ResponseFormat">ResponseFormat</a></li>
    <li><a href="#Id">Id</a></li>
    <li><a href="#FormattedResource">FormattedResource</a></li>
    <li><a href="#Cookies">Cookies</a></li>
    <li><a href="#Headers">Headers</a></li>
    <li><a href="#QuerystringParams">QuerystringParams</a></li>
    <li><a href="#UrlSegments">UrlSegments</a></li>
    
    <li class="toc-subsection"><a href="#WebRequest-Methods">Methods</a></li>
    <li><a href="#AddCookie">AddCookie</a></li>
    <li><a href="#AddHeader">AddHeader</a></li>
    <li><a href="#AddQuerystringParam">AddQuerystringParam</a></li>
    <li><a href="#AddUrlSegment">AddUrlSegment</a></li>
    <li><a href="#CustomBodyConverter">CustomBodyConverter</a></li>
    <li><a href="#CustomResponseParser">CustomResponseParser</a></li>
    <li><a href="#Clone">Clone</a></li>
  </ul>
  <a class="toc-title" href="#">
    WebClient
  </a>
  <ul class="toc-section">
    <li class="toc-subsection"><a href="#WebClient-Properties">Properties</a></li>
    <li><a href="#BaseUrl">BaseUrl</a></li>
    <li><a href="#Username">Username</a></li>
    <li><a href="#Password">Password</a></li>
    <li><a href="#Authenticator">Authenticator</a></li>
    <li><a href="#TimeoutMS">TimeoutMS</a></li>
    <li><a href="#ProxyServer">ProxyServer</a></li>
    <li><a href="#ProxyUsername">ProxyUsername</a></li>
    <li><a href="#ProxyPassword">ProxyPassword</a></li>
    <li><a href="#ProxyBypassList">ProxyBypassList</a></li>

    <li class="toc-subsection"><a href="#WebClient-Methods">Methods</a></li>
    <li><a href="#Execute">Execute</a></li>
    <li><a href="#GetJSON">GetJSON</a></li>
    <li><a href="#PostJSON">PostJSON</a></li>
    <li><a href="#SetProxy">SetProxy</a></li>
    <li><a href="#PrepareRequest">PrepareRequest</a></li>
    <li><a href="#PrepareHttpRequest">PrepareHttpRequest</a></li>
    <li><a href="#PrepareCURL">PrepareCURL</a></li>
  </ul>
  <a class="toc-title" href="#">
    WebResponse
  </a>
  <ul class="toc-section">
    <li><a href="#"></a></li>
  </ul>
  <a class="toc-title" href="#">
    WebHelpers
  </a>
  <ul class="toc-section">
    <li><a href="#"></a></li>
  </ul>
</aside>
<article class="documentation">
  <h2 id="Introduction" class="docs-title">Introduction</h2>
  <h4 id="Installation" class="docs-name">Installation</h4>

  <h2 id="WebRequest" class="docs-title">WebRequest</h2>
  <section class="docs-subsection">
    <h3 id="WebRequest-Properties" class="docs-subsection-title">Properties</h3>
    
    <h4 id="Resource"><b class="docs-name">Resource</b><code>Get|Let {String}</code></h4>
    <p>
      Set the request's portion of the url to be appended to the client's <a href="#BaseUrl" class="docs-code-link"><code>BaseUrl</code></a>.
      Can include <a href="#UrlSegments">Url Segments</a> for dynamic values
      and <a href="#QuerystringParams">Querystring parameters</a> are smart enough to be appended to existing querystring
      (or added to resource if there isn't an existing querystring).
    </p>

{% highlight VB.net %}
Dim Client As New WebClient
Client.BaseUrl = "https://api.example.com/"

Dim Request As New WebRequest
Request.Resource = "messages"

' -> Url: https://api.example.com/messages

Request.Resource = "messages/{id}?a=1"
Request.AddUrlSegment "id", 123
Request.AddQuerystringParam "b", 2

' -> Url: https://api.example.com/messages/123?a=1&b=2
{% endhighlight %}

    <h4 id="Method"><b class="docs-name">Method</b><code>Get|Let {WebMethod}</code></h4>
    <p>
      Set the HTTP method to be used for the request: GET, POST, PUT, PATCH, DELETE
    </p>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.Method = WebMethod.HTTPGET
Request.Method = WebMethod.HTTPPOST
Request.Method = WebMethod.HTTPPUT
Request.Method = WebMethod.HTTPPATCH
Request.Method = WebMethod.HTTPDELETE
{% endhighlight %}

    <h4 id="Format"><b class="docs-name">Format</b><code>Get|Set {WebFormat}</code></h4>
    <p>
      Set <code>RequestFormat</code>, <code>ResponseFormat</code>, and <code>Content-Type</code> and <code>Accept</code> headers for the <code>WebRequest</code>
    </p>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.Format = WebFormat.JSON
' -> Request.RequestFormat = WebFormat.JSON
'    Request.ResponseFormat = WebFormat.JSON
'    Content-Type: application/json
'    Accept: application/json
{% endhighlight %}

    <h4 id="Body"><b class="docs-name">Body</b><code>Get|Let|Set {Variant}</code></h4>
    <ul>
      <li><code>Get</code> Body value converted to string using <code>RequestFormat</code> or <code>TODO</code></li>
      <li><code>Let</code> Use <code>String</code> or <code>Array</code> for Body</li>
      <li><code>Set</code> Use <code>Collection</code>, <code>Dictionary</code>, or <code>Object</code> for Body</li>
    </ul>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.RequestFormat = WebFormat.JSON

' Let: String|Array
Request.Body = "text"
Request.Body ' = "text"
Request.Body = Array("A", "B", "C")

' Get: Returns Body converted to string
Request.Body ' = "["A","B","C"]"

' Set: Collection|Dictionary|Object
Dim Body As Object
Set Body = New Collection
Body.Add "Howdy!"
Set Request.Body = Body
Request.Body ' = "["Howdy!"]"

Set Body = New Dictionary
Body.Add "a", 123
Body.Add "b", 456
Set Request.Body = Body
Request.Body ' = "{"a":123,"b":456}"
{% endhighlight %}

    <h4 id="RequestFormat"><b class="docs-name">RequestFormat</b><code>Get|Let {WebFormat}</code></h4>
    <p>
      Set the format to use for converting the response <code>Content</code> to <code>Data</code> 
      and for the <code>Accept</code> header
      <br>
      <i>Note</i>: If <code>WebFormat.Custom</code> is used, the <code>Content-Type</code> header
      must be added explicitly with <a href="#AddHeader" class="docs-code-link"><code>AddHeader</code></a> 
      and the <a href="#TODO" class="docs-code-link"><code>TODO</code></a> should be set.
    </p>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.Body = Array("A", "B", "C")

Request.RequestFormat = WebFormat.JSON

' -> Content-Type: application/json
' -> Convert Body to JSON string
Request.Body ' = "["A","B","C"]"

' For custom format, set 
Request.RequestFormat = WebFormat.Custom
Request.AddHeader "Content-Type", "..."
Request.TODO = ...
{% endhighlight %}

    <h4 id="ResponseFormat"><b class="docs-name">ResponseFormat</b><code>Get|Let {WebFormat}</code></h4>
    <p>
      Set the format to use for converting the response <code>Content</code> to <code>Data</code> 
      and for the <code>Accept</code> header
      <br>
      <i>Note</i>: If <code>WebFormat.Custom</code> is used, the <code>Accept</code> header
      must be added explicitly with <a href="#AddHeader" class="docs-code-link"><code>AddHeader</code></a> 
      and the <a href="#TODO" class="docs-code-link"><code>TODO</code></a> should be set.
    </p>

{% highlight VB.net %}
Dim Request As New WebRequest
Request.ResponseFormat = WebFormat.JSON

' -> Accept: application/json

Dim Response As WebResponse
' ... from Execute
Response.Content ' = {"message":"Howdy!"}

' -> Parse Content to JSON Dictionary
Response.Data("message") ' = "Howdy!"

' For custom format, set 
Request.ResponseFormat = WebFormat.Custom
Request.AddHeader "Accept", "..."
Request.TODO = ...
{% endhighlight %}
    
    <h4 id="Id"><b class="docs-name">Id</b><code>Get {String}</code></h4>
    <p>
      Unique Id of the <code>WebRequest</code> (used internally).
    </p>

    <h4 id="FormattedResource"><b class="docs-name">FormattedResource</b><code>Get {String}</code></h4>
    <p>
      Get <code>Resource</code> with Url Segments replaced and Querystring added.
    </p>
      
{% highlight VB.net %}
Dim Request As New WebRequest
Request.Resource = "examples/{id}"
Request.AddUrlSegment "id", 123
Request.AddQuerystringParam "message", "Hello"

Request.FormattedResource ' = "examples/123?message=Hello"
{% endhighlight %}

    <h4 id="Cookies"><b class="docs-name">Cookies</b><code>Get|Set {Collection}</code></h4>
    <p>
      <span class="docs-note"></span>To add cookies, use <a href="#AddCookie" class="docs-code-link"><code>AddCookie</code></a>.</span>
      <br>
      <code>Collection</code> of Cookies to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>).
    </p>
    
    <h4 id="Headers"><b class="docs-name">Headers</b><code>Get|Set {Collection}</code></h4>
    <p>
      <span class="docs-note"></span>To add headers, use <a href="#AddHeader" class="docs-code-link"><code>AddHeader</code></a>.</span>
      <br>
      <code>Collection</code> of Headers to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>).
    </p>
    
    <h4 id="QuerystringParams"><b class="docs-name">QuerystringParams</b><code>Get|Set {Collection}</code></h4>
    <p>
      <span class="docs-note"></span>To add Querystring parameters, use <a href="#AddQuerystringParam" class="docs-code-link"><code>AddQuerystringParam</code></a>.</span>
      <br>
      <code>Collection</code> of Querystring parameters to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>)
    </p>
    
    <h4 id="UrlSegments"><b class="docs-name">UrlSegments</b><code>Get|Set {Dictionary}</code></h4>
    <p>
      <span class="docs-note"></span>To add Url Segments, use <a href="#AddUrlSegment" class="docs-code-link"><code>AddUrlSegment</code></a>.</span>
      <br>
      <code>Collection</code> of Headers to include with request, 
      stored as <code>WebHelpers.KeyValue</code> (<code>Dictionary: {key: "", value: ""}</code>.
      Url Segments are used to easily add dynamic values to <code>Resource</code>.
      Create a Url Segment in <code>Resource</code> with curly brackets and then replace with dynamic value with <a href="#AddUrlSegment"><code>AddUrlSegment</code></a>:
    </p>

{% highlight VB.net %}
Dim Request As New WebRequest

Dim User As String
Dim Id As Long
User = "Tim"
Id = 123

' OK: Use string concatenation for dynamic values
Request.Resource = User & "/messages/" & Id

' BETTER: Use Url Segments for dynamic values
Request.Resource = "{user}/messages/{id}"
Request.AddUrlSegment "user", User
Request.AddUrlSegment "id", Id

Request.FormattedResource ' = "Tim/messages/123"
{% endhighlight %}

  </section>

  <section>
    <h3 id="WebRequest-Methods" class="docs-subsection-title">Methods</h3>
    
    <h4 id="AddCookie"><b class="docs-name">AddCookie</b><code>AddCookie(Key, Value)</code></h4>
    <p>
      Add cookie to be sent with request.
    </p>
    <h4 id="AddHeader"><b class="docs-name">AddHeader</b><code>AddHeader(Key, Value)</code></h4>
    <p>
      Add header to be sent with request.
    </p>
    <h4 id="AddQuerystringParam"><b class="docs-name">AddQuerystringParam</b><code>AddQuerystringParam(Key, Value)</code></h4>
    <p>
      Add querystring parameter to <code>FormattedResource</code> for request
    </p>
    <h4 id="AddUrlSegment"><b class="docs-name">AddUrlSegment</b><code>AddUrlSegment(Key, Value)</code></h4>
    <p>
      Add url segment to replace in <code>Resource</code>
    </p>
      
{% highlight VB.net %}
Dim Request As New WebRequest
Request.Resource = "{user}/messages/{id}"

Request.AddUrlSegment "user", "Tim"
Request.AddUrlSegment "id", 123

Request.FormattedResource ' = "Tim/messages/123"
{% endhighlight %}
    
    <h4 id="CustomBodyConverter"><b class="docs-name">CustomBodyConverter</b><code>CustomBodyConverter(Callback, [Context|Host|Parent|Instance])</code></h4>
    <p>
      Register custom body converter with Function signature: <code>...(Body As Variant) As String</code>.
      When used, the <code>RequestFormat</code> is automatically set to <code>WebFormat.Custom</code>
      and the <code>Content-Type</code> header should be set explicitly with <a href="AddHeader"><code>AddHeader</code></a>
    </p>
    
{% highlight VB.net %}
Dim Request As New WebRequest

' Set body converter to be Public Function declared in Module
Request.CustomBodyConverter "Module.FunctionThatReturnsString"

' Set body converter to be Public Function declared in the given class instance
Dim Instance As New ...
Request.CustomBodyConverter "FunctionInsideOfInstance", Instance
{% endhighlight %}

    <h4 id="CustomResponseParser"><b class="docs-name">CustomResponseParser</b><code>CustomResponseParser(Callback, [Instance])</code></h4>
    <p>
      Register custom response parser with Function signature: <code>...(Content As String, Body As Variant) As Variant</code>.
      When used, the <code>ResponseFormat</code> is automatically set to <code>WebFormat.Custom</code>
      and the <code>Accept</code> header should be set explicitly with <a href="AddHeader"><code>AddHeader</code></a>
    </p>
    
{% highlight VB.net %}
Dim Request As New WebRequest

' Set response parser to be Public Function declared in Module
Request.CustomResponseParser "Module.FunctionThatReturnsVariant"

' Set response parser to be Public Function declared in the given class instance
Dim Instance As New ...
Request.CustomResponseParser "FunctionInsideOfInstance", Instance
{% endhighlight %}
    
    <h4 id="Clone"><b class="docs-name">Clone</b><code>Clone() {WebRequest}</code></h4>
    <p>
      Clone the request (used internally for async functionality)
    </p>
  </section>

  <p>
    Items to remove:
    <ul>
      <li><b>Parameters</b>: Explicitly use <code>QuerystringParams</code> or <code>Body</code></li>
      <li><b>BaseUrl</b>: Should only be used in <code>WebClient</code></li>
      <li><b>RequireHTTPS</b>: Should be set explicitly in <code>WebClient.BaseUrl</code> or <code>WebRequest.Resource</code></li>
      <li><b>IncludeContentLength</b>: Should alway be included</li>
      <li><b>FullUrl</b>: Should be determined in <code>WebClient</code></li>
      <li><b>MethodName</b>: Don't need explicit Property for this</li>
      <li><b>FormatName</b>: Only used in <code>{format}</code>, set explicitly if needed</li>
      <li><b>ContentType</b>: Set with <code>AddHeader</code> if needed</li>
      <li><b>Accept</b>: Set with <code>AddHeader</code> if needed</li>
      <li><b>ContentLength</b>: No reason it should be different size than actual content length</li>
      <li><b>AddParameter</b>: Explicitly use <code>AddQuerystringParam</code> or <code>Body</code></li>
      <li><b>AddBody</b>: Use Let/Set with <code>Body</code></li>
      <li><b>AddBodyString</b>: Use Let with <code>Body</code></li>
    </ul>
  </p>

  <h2 id="WebClient">WebClient</h2>
  <section class="docs-subsection">
    <h3 id="WebClient-Properties" class="docs-subsection-title">Properties</h3>

    <h4 id="BaseUrl"><b class="docs-name">BaseUrl</b><code>Get|Let {String}</code></h4>
    <p>
      Set base url that is shared by all requests and that the request <code>Resource></code> is appended to
    </p>
      
{% highlight VB.net %}
' Desired URLs
' https://api.example.com/v1/messages
' https://api.example.com/v1/users/id
'                           ^
' -> Split by shared base url and unique request resource

Dim Client As New WebClient
Client.BaseUrl = "https://api.example.com/v1/"

Dim Request As New WebRequest
Request.Resource = "messages"
Request.Resource = "users/{id}"
{% endhighlight %}

    <h4 id="Username"><b class="docs-name">Username</b><code>Get|Let {String}</code></h4>
    <p>
      Username for Basic Authentication
    </p>
    <h4 id="Password"><b class="docs-name">Password</b><code>Get|Let {String}</code></h4>
    <p>
      Password for Basic Authentication
    </p>

    <h4 id="Authenticator"><b class="docs-name">Authenticator</b><code>Get|Set {IAuthenticator}</code></h4>
    <p>
      Attach an authenticator to the client for authenticating requests.
    </p>
      
{% highlight VB.net %}
Dim Client As New WebClient
Dim Auth As New OAuth1Authenticator
Auth.Setup ...

Set Client.Authenticator = Auth
' -> All requests use Auth to add "Authorization" header
{% endhighlight %}
    
    <h4 id="TimeoutMS"><b class="docs-name">TimeoutMS</b><code>Get|Let {Long}</code></h4>
    <p>
      Timeout (in milliseconds) to wait for timeout in each request phase (Resolve, Connect, Send, Receive)
    </p>

    <h4 id="ProxyServer"><b class="docs-name">ProxyServer</b><code>Get|Let {String}</code></h4>
    <p>
      Proxy server to pass requests through (except for those that match bypass list)
    </p>
    <h4 id="ProxyUsername"><b class="docs-name">ProxyUsername</b><code>Get|Let {String}</code></h4>
    <p>
      Username for proxy
    </p>
    <h4 id="ProxyPassword"><b class="docs-name">ProxyPassword</b><code>Get|Let {String}</code></h4>
    <p>
      Password for proxy
    </p>
    <h4 id="ProxyBypassList"><b class="docs-name">ProxyBypassList</b><code>Get|Let {String}</code></h4>
    <p>
      Comma separated list of domains to bypass the proxy
    </p>
    
  </section>
  <sectionclass="docs-subsection">
    <h3 id="WebClient:Methods" class="docs-subsection-title">Methods</h3>
    
    <h4 id="Execute"><b class="docs-name">Execute</b><code>Execute(Request) {WebResponse}</code></h4>
    <p>
      TODO...
    </p>
    <h4 id="GetJSON"><b class="docs-name">GetJSON</b><code>GetJSON(Url, [Options]) {WebResponse}</code></h4>
    <p>
      TODO...
    </p>
    <h4 id="PostJSON"><b class="docs-name">PostJSON</b><code>PostJSON(Url, Body, [Options]) {WebResponse}</code></h4>
    <p>
      TODO...
    </p>
    <h4 id="SetProxy"><b class="docs-name">SetProxy</b><code>SetProxy(Server, [Username], [Password], [BypassList])</code></h4>
    <p>
      TODO...
    </p>
    <h4 id="PrepareRequest"><b class="docs-name">PrepareRequest</b><code>PrepareRequest(Request) {WebRequest}</code></h4>
    <p>
      (Internal) TODO...
    </p>
    <h4 id="PrepareHttpRequest"><b class="docs-name">PrepareHttpRequest</b><code>PrepareHttpRequest(Request, [Async]) {WinHttpRequest}</code></h4>
    <p>
      (Internal) TODO...
    </p>
    <h4 id="PrepareCURL"><b class="docs-name">PrepareCURL</b><code>PrepareCURL(Request) {String}</code></h4>
    <p>
      (Internal) TODO...
    </p>
  </section>
  
  <h2 id="WebResponse">WebResponse</h2>
  <h2 id="WebHelpers">WebHelpers</h2>
  <h2 id="WebAsyncWrapper">WebAsyncWrapper</h2>
</article>
